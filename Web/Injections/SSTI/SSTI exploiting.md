# RTFM!
Determine template engine first, then:
* Read docs of used template engine
* Especially the Security section
* Google/gpt for known exploits

## Explore
For example, in Java-based templating languages, you can sometimes list all variables in the environment using the following injection:

```
${T(java.lang.System).getenv()}
```

This can form the basis for creating a shortlist of potentially interesting objects and methods to investigate further. Additionally, for Burp Suite Professional users, the Intruder provides a built-in wordlist for brute-forcing variable names.

## Create a custom attack
#### Constructing a custom exploit using an object chain
 For example, in the Java-based template engine Velocity, you have access to a ClassTool object called $class. Studying the documentation reveals that you can chain the $class.inspect() method and $class.type property to obtain references to arbitrary objects. In the past, this has been exploited to execute shell commands on the target system as follows:
```
$class.inspect("java.lang.Runtime").type.getRuntime().exec("bad-stuff-here")
```